# **–ù–µ–¥–µ–ª—è 8: –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–Ω–∏–≥ (–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç)**

## **üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞**
–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –∫–Ω–∏–≥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å–µ—Ö –∏–∑—É—á–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π: FastAPI, Pydantic, SQLAlchemy, Dependency Injection.

## **üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–µ–∫—Ç—É**

### **–û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –†–∞–±–æ—Ç–∞—é—â–µ–µ REST API
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑—É—á–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π
- ‚úÖ –ß–∏—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger/ReDoc
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

#### **1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∞–º–∏**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–Ω–∏–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –ü–æ–∏—Å–∫ –∫–Ω–∏–≥ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∞–≤—Ç–æ—Ä—É, –∂–∞–Ω—Ä—É
- –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–Ω–∏–≥–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–Ω–∏–≥ (–¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–Ω–∏–≥–µ
- –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–Ω–∏–≥

#### **2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT —Ç–æ–∫–µ–Ω—ã)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å (—á–∏—Ç–∞—Ç–µ–ª—å, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)

#### **3. –°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ –Ω–∞ –ø–µ—Ä–∏–æ–¥
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
- –í–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥–∏
- –ò—Å—Ç–æ—Ä–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

#### **4. –†–µ–π—Ç–∏–Ω–≥–∏ –∏ –æ—Ç–∑—ã–≤—ã**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ –∫ –∫–Ω–∏–≥–µ
- –û—Ü–µ–Ω–∫–∞ –∫–Ω–∏–≥–∏ (1-5 –∑–≤–µ–∑–¥)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –∫–Ω–∏–≥—É

## **üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
```
library_api/
‚îú‚îÄ‚îÄ .env.example                    # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ pyproject.toml                  # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ README.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ requirements.txt
‚îÇ
‚îú‚îÄ‚îÄ app/                            # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                     # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ api/                        # –†–æ—É—Ç–µ—Ä—ã API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ v1/                     # API –≤–µ—Ä—Å–∏—è 1
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.py              # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ endpoints/          # –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.py         # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ books.py        # –ö–Ω–∏–≥–∏
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ users.py        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ bookings.py     # –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ reviews.py      # –û—Ç–∑—ã–≤—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ deps.py                 # –û–±—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ core/                       # –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py             # JWT, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py             # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exceptions.py           # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ models/                     # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py                 # –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py                 # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ book.py                 # –ö–Ω–∏–≥–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ booking.py              # –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ review.py               # –û—Ç–∑—ã–≤—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ author.py               # –ê–≤—Ç–æ—Ä—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ schemas/                    # Pydantic –º–æ–¥–µ–ª–∏ (–∫–∞—Ç–∞–ª–æ–≥ schemas/, –Ω–æ —ç—Ç–æ Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è API)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ book.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ booking.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ review.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/                   # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_service.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ book_service.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ booking_service.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth_service.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ repositories/               # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py                 # –ë–∞–∑–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_repository.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ book_repository.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ booking_repository.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ review_repository.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ dependencies/               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ FastAPI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py                 # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ commons.py              # –û–±—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/                      # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ pagination.py           # –ü–∞–≥–∏–Ω–∞—Ü–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ validators.py           # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
‚îÇ
‚îú‚îÄ‚îÄ tests/                          # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py                 # –§–∏–∫—Å—Ç—É—Ä—ã pytest
‚îÇ   ‚îú‚îÄ‚îÄ test_api/                   # –¢–µ—Å—Ç—ã API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_auth.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_books.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_users.py
‚îÇ   ‚îî‚îÄ‚îÄ test_services/              # –¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ test_book_service.py
‚îÇ       ‚îî‚îÄ‚îÄ test_auth_service.py
‚îÇ
‚îú‚îÄ‚îÄ migrations/                     # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (Alembic)
‚îÇ   ‚îú‚îÄ‚îÄ versions/
‚îÇ   ‚îî‚îÄ‚îÄ env.py
‚îÇ
‚îî‚îÄ‚îÄ scripts/                        # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
    ‚îú‚îÄ‚îÄ init_db.py                  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
    ‚îú‚îÄ‚îÄ create_admin.py             # –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    ‚îî‚îÄ‚îÄ seed_data.py                # –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```

## **üìù –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API**

### **1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**

#### **–ú–æ–¥–µ–ª–∏:**
```python
# app/models/user.py
from enum import Enum
from datetime import datetime

class UserRole(str, Enum):
    READER = "reader"
    LIBRARIAN = "librarian"
    ADMIN = "admin"

class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True)
    email = Column(String(255), unique=True, index=True, nullable=False)
    username = Column(String(100), unique=True, index=True, nullable=False)
    hashed_password = Column(String(255), nullable=False)
    full_name = Column(String(200))
    role = Column(Enum(UserRole), default=UserRole.READER, nullable=False)
    is_active = Column(Boolean, default=True, nullable=False)
    is_verified = Column(Boolean, default=False, nullable=False)
    created_at = Column(DateTime, default=datetime.now, nullable=False)
    updated_at = Column(DateTime, default=datetime.now, onupdate=datetime.now)
    
    # –û—Ç–Ω–æ—à–µ–Ω–∏—è
    bookings = relationship("Booking", back_populates="user", cascade="all, delete-orphan")
    reviews = relationship("Review", back_populates="user", cascade="all, delete-orphan")
```

#### **Endpoints:**
```
POST   /api/v1/auth/register       # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
POST   /api/v1/auth/login          # –í—Ö–æ–¥ (–ø–æ–ª—É—á–µ–Ω–∏–µ JWT)
POST   /api/v1/auth/refresh        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
POST   /api/v1/auth/logout         # –í—ã—Ö–æ–¥ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
GET    /api/v1/auth/me             # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

GET    /api/v1/users/              # –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
GET    /api/v1/users/{user_id}     # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
PUT    /api/v1/users/{user_id}     # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
DELETE /api/v1/users/{user_id}     # –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º—è–≥–∫–æ–µ)
```

### **2. –ö–Ω–∏–≥–∏ –∏ –∞–≤—Ç–æ—Ä—ã**

#### **–ú–æ–¥–µ–ª–∏:**
```python
# app/models/book.py
class Book(Base):
    __tablename__ = "books"
    
    id = Column(Integer, primary_key=True, index=True)
    title = Column(String(500), nullable=False, index=True)
    isbn = Column(String(17), unique=True, nullable=False)  # ISBN-13
    description = Column(Text)
    publication_year = Column(Integer, nullable=False)
    publisher = Column(String(255))
    language = Column(String(2), default="ru")
    pages = Column(Integer)
    cover_image = Column(String(500))  # URL –æ–±–ª–æ–∂–∫–∏
    
    # –¶–µ–Ω–∞ –∏ –Ω–∞–ª–∏—á–∏–µ
    price = Column(Float, nullable=False)
    total_copies = Column(Integer, default=1, nullable=False)
    available_copies = Column(Integer, default=1, nullable=False)
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    average_rating = Column(Float, default=0.0)
    rating_count = Column(Integer, default=0)
    
    # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
    created_at = Column(DateTime, default=datetime.now)
    updated_at = Column(DateTime, default=datetime.now, onupdate=datetime.now)
    is_deleted = Column(Boolean, default=False)
    
    # –í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏
    author_id = Column(Integer, ForeignKey('authors.id'), nullable=False)
    
    # –û—Ç–Ω–æ—à–µ–Ω–∏—è
    author = relationship("Author", back_populates="books")
    bookings = relationship("Booking", back_populates="book")
    reviews = relationship("Review", back_populates="book")

class Author(Base):
    __tablename__ = "authors"
    
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String(200), nullable=False, index=True)
    biography = Column(Text)
    birth_date = Column(Date)
    death_date = Column(Date, nullable=True)
    country = Column(String(100))
    photo_url = Column(String(500))
    
    # –û—Ç–Ω–æ—à–µ–Ω–∏—è
    books = relationship("Book", back_populates="author")
```

#### **Endpoints –¥–ª—è –∫–Ω–∏–≥:**
```
GET    /api/v1/books/              # –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
GET    /api/v1/books/{book_id}     # –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
POST   /api/v1/books/              # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å/–∞–¥–º–∏–Ω)
PUT    /api/v1/books/{book_id}     # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å/–∞–¥–º–∏–Ω)
DELETE /api/v1/books/{book_id}     # –£–¥–∞–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏ (–∞–¥–º–∏–Ω)
GET    /api/v1/books/{book_id}/reviews  # –û—Ç–∑—ã–≤—ã –Ω–∞ –∫–Ω–∏–≥—É

# –§–∏–ª—å—Ç—Ä—ã –¥–ª—è GET /api/v1/books/:
?q=–ø–æ–∏—Å–∫–æ–≤—ã–π_–∑–∞–ø—Ä–æ—Å
?author_id=1
?min_year=2000
?max_year=2024
?min_price=100
?max_price=5000
?available_only=true
?sort_by=title|year|price|rating
?sort_order=asc|desc
?page=1
?size=20
```

#### **Endpoints –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤:**
```
GET    /api/v1/authors/            # –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤
GET    /api/v1/authors/{author_id} # –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
GET    /api/v1/authors/{author_id}/books  # –ö–Ω–∏–≥–∏ –∞–≤—Ç–æ—Ä–∞
POST   /api/v1/authors/            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å/–∞–¥–º–∏–Ω)
PUT    /api/v1/authors/{author_id} # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å/–∞–¥–º–∏–Ω)
```

### **3. –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**

#### **–ú–æ–¥–µ–ª—å:**
```python
# app/models/booking.py
from enum import Enum

class BookingStatus(str, Enum):
    PENDING = "pending"      # –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    ACTIVE = "active"        # –ê–∫—Ç–∏–≤–Ω–∞ (–∫–Ω–∏–≥–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
    COMPLETED = "completed"  # –ó–∞–≤–µ—Ä—à–µ–Ω–∞ (–∫–Ω–∏–≥–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞)
    CANCELLED = "cancelled"  # –û—Ç–º–µ–Ω–µ–Ω–∞
    OVERDUE = "overdue"      # –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–∞

class Booking(Base):
    __tablename__ = "bookings"
    
    id = Column(Integer, primary_key=True, index=True)
    status = Column(Enum(BookingStatus), default=BookingStatus.PENDING, nullable=False)
    
    # –î–∞—Ç—ã
    booking_date = Column(DateTime, default=datetime.now, nullable=False)
    start_date = Column(DateTime, nullable=False)
    end_date = Column(DateTime, nullable=False)
    actual_return_date = Column(DateTime, nullable=True)
    
    # –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
    notes = Column(Text)
    cancellation_reason = Column(Text)
    
    # –í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏
    user_id = Column(Integer, ForeignKey('users.id'), nullable=False)
    book_id = Column(Integer, ForeignKey('books.id'), nullable=False)
    
    # –û—Ç–Ω–æ—à–µ–Ω–∏—è
    user = relationship("User", back_populates="bookings")
    book = relationship("Book", back_populates="bookings")
    
    # –°–≤–æ–π—Å—Ç–≤–∞
    @property
    def is_active(self):
        return self.status == BookingStatus.ACTIVE
    
    @property
    def is_overdue(self):
        if not self.is_active or not self.end_date:
            return False
        return datetime.now() > self.end_date and self.actual_return_date is None
```

#### **Endpoints:**
```
POST   /api/v1/bookings/           # –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
GET    /api/v1/bookings/           # –ú–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
GET    /api/v1/bookings/{booking_id} # –î–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
PUT    /api/v1/bookings/{booking_id} # –û–±–Ω–æ–≤–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
DELETE /api/v1/bookings/{booking_id} # –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
POST   /api/v1/bookings/{booking_id}/return  # –í–µ—Ä–Ω—É—Ç—å –∫–Ω–∏–≥—É
GET    /api/v1/users/{user_id}/bookings # –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–¥–º–∏–Ω/–±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å)
```

### **4. –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏**

#### **–ú–æ–¥–µ–ª—å:**
```python
# app/models/review.py
class Review(Base):
    __tablename__ = "reviews"
    
    id = Column(Integer, primary_key=True, index=True)
    rating = Column(Integer, nullable=False)  # 1-5
    comment = Column(Text)
    created_at = Column(DateTime, default=datetime.now, nullable=False)
    updated_at = Column(DateTime, default=datetime.now, onupdate=datetime.now)
    is_verified_purchase = Column(Boolean, default=False)
    
    # –í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏
    user_id = Column(Integer, ForeignKey('users.id'), nullable=False)
    book_id = Column(Integer, ForeignKey('books.id'), nullable=False)
    
    # –û—Ç–Ω–æ—à–µ–Ω–∏—è
    user = relationship("User", back_populates="reviews")
    book = relationship("Book", back_populates="reviews")
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è
    __table_args__ = (
        CheckConstraint('rating >= 1 AND rating <= 5', name='check_rating_range'),
        UniqueConstraint('user_id', 'book_id', name='unique_user_book_review'),
    )
```

#### **Endpoints:**
```
POST   /api/v1/reviews/            # –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
GET    /api/v1/reviews/{review_id} # –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∑—ã–≤
PUT    /api/v1/reviews/{review_id} # –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–∑—ã–≤
DELETE /api/v1/reviews/{review_id} # –£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤
GET    /api/v1/books/{book_id}/reviews  # –û—Ç–∑—ã–≤—ã –Ω–∞ –∫–Ω–∏–≥—É
GET    /api/v1/users/{user_id}/reviews  # –û—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

## **üîß –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **–®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```bash
# 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
mkdir library_api && cd library_api

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
.\venv\Scripts\activate   # Windows

# 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫
mkdir -p app/{api/v1/endpoints,core,models,schemas,services,repositories,dependencies,utils}
mkdir -p tests/{test_api,test_services}
mkdir -p scripts migrations/versions

# 4. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
touch app/__init__.py app/main.py
touch app/api/__init__.py app/api/v1/__init__.py app/api/v1/api.py
touch app/core/__init__.py app/core/{config.py,security.py,database.py}
# ... –∏ —Ç–∞–∫ –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
```

### **–®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

**requirements.txt (–≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–º–µ—Ä–Ω—ã–µ, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç–µ):**
```txt
# FastAPI –∏ —Å–µ—Ä–≤–µ—Ä
fastapi==0.115.0
uvicorn[standard]==0.32.0

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
sqlalchemy==2.0.36
asyncpg==0.29.0
aiosqlite==0.19.0
alembic==1.14.0

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.9

# –í–∞–ª–∏–¥–∞—Ü–∏—è
pydantic==2.5.0
pydantic-settings==2.1.0
email-validator==2.1.0

# –£—Ç–∏–ª–∏—Ç—ã
python-dotenv==1.0.0
httpx==0.27.0

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
pytest==8.3.0
pytest-asyncio==0.23.0

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
mkdocs==1.6.0
mkdocs-material==9.5.3
```

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

### **–®–∞–≥ 3: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**

**.env —Ñ–∞–π–ª:**
```env
# Application
PROJECT_NAME=Library API
VERSION=1.0.0
API_V1_STR=/api/v1
DEBUG=True

# Database
DATABASE_URL=sqlite+aiosqlite:///./library.db
# –ò–ª–∏ –¥–ª—è PostgreSQL:
# DATABASE_URL=postgresql+asyncpg://user:password@localhost/library_db

# Security
SECRET_KEY=your-secret-key-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# CORS
BACKEND_CORS_ORIGINS=["http://localhost:3000", "http://localhost:8000"]
```

**app/core/config.py:**
```python
from pydantic_settings import BaseSettings
from typing import List
import os
from dotenv import load_dotenv

load_dotenv()

class Settings(BaseSettings):
    PROJECT_NAME: str = "Library API"
    VERSION: str = "1.0.0"
    API_V1_STR: str = "/api/v1"
    DEBUG: bool = False
    
    SECRET_KEY: str = os.getenv("SECRET_KEY", "dev-secret-key")
    ALGORITHM: str = "HS256"
    ACCESS_TOKEN_EXPIRE_MINUTES: int = 30
    
    DATABASE_URL: str = os.getenv("DATABASE_URL", "sqlite+aiosqlite:///./library.db")
    
    BACKEND_CORS_ORIGINS: List[str] = ["http://localhost:3000"]
    
    class Config:
        case_sensitive = True

settings = Settings()
```

### **–®–∞–≥ 4: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**

**app/core/database.py:**
```python
from typing import AsyncGenerator
from sqlalchemy.ext.asyncio import AsyncSession, create_async_engine
from sqlalchemy.orm import sessionmaker, declarative_base
from app.core.config import settings

engine = create_async_engine(
    settings.DATABASE_URL,
    echo=settings.DEBUG,
)

AsyncSessionLocal = sessionmaker(
    engine,
    class_=AsyncSession,
    expire_on_commit=False,
)

Base = declarative_base()

async def get_db() -> AsyncGenerator[AsyncSession, None]:
    async with AsyncSessionLocal() as session:
        try:
            yield session
            await session.commit()
        except Exception:
            await session.rollback()
            raise
        finally:
            await session.close()

async def init_db():
    """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)"""
    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.create_all)
```

### **–®–∞–≥ 5: –ú–æ–¥–µ–ª–∏ SQLAlchemy**

**app/models/base.py:**
```python
from sqlalchemy import Column, Integer, Boolean, DateTime, func
from sqlalchemy.orm import DeclarativeBase
from datetime import datetime

class Base(DeclarativeBase):
    pass

class TimestampMixin:
    created_at = Column(DateTime, default=func.now(), nullable=False)
    updated_at = Column(DateTime, default=func.now(), onupdate=func.now())

class SoftDeleteMixin:
    is_deleted = Column(Boolean, default=False, nullable=False)
    deleted_at = Column(DateTime, nullable=True)
    
    def soft_delete(self):
        self.is_deleted = True
        self.deleted_at = datetime.now()
```

### **–®–∞–≥ 6: Pydantic –º–æ–¥–µ–ª–∏ (–∫–∞—Ç–∞–ª–æ–≥ schemas/)**

**app/schemas/book.py:**
```python
from pydantic import BaseModel, Field, ConfigDict
from typing import Optional, List
from datetime import datetime
from enum import Enum

class BookStatus(str, Enum):
    AVAILABLE = "available"
    BORROWED = "borrowed"
    RESERVED = "reserved"

class BookBase(BaseModel):
    title: str = Field(..., min_length=1, max_length=500)
    isbn: str = Field(..., pattern=r'^\d{3}-\d-\d{3}-\d{5}-\d$')
    description: Optional[str] = None
    publication_year: int = Field(..., ge=1000, le=datetime.now().year)
    publisher: Optional[str] = None
    language: str = Field("ru", min_length=2, max_length=2)
    pages: Optional[int] = Field(None, ge=1)
    price: float = Field(..., gt=0)
    total_copies: int = Field(1, ge=1)

class BookCreate(BookBase):
    author_id: int

class BookUpdate(BaseModel):
    title: Optional[str] = Field(None, min_length=1, max_length=500)
    description: Optional[str] = None
    price: Optional[float] = Field(None, gt=0)
    total_copies: Optional[int] = Field(None, ge=1)

class BookResponse(BookBase):
    id: int
    author_id: int
    available_copies: int
    average_rating: float
    status: BookStatus
    created_at: datetime
    updated_at: Optional[datetime] = None
    
    model_config = ConfigDict(from_attributes=True)
```

### **–®–∞–≥ 7: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**

**app/repositories/base.py:**
```python
from typing import Generic, TypeVar, Type, Optional, List
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, update, delete
from app.models.base import Base

ModelType = TypeVar("ModelType", bound=Base)

class BaseRepository(Generic[ModelType]):
    def __init__(self, model: Type[ModelType], db: AsyncSession):
        self.model = model
        self.db = db
    
    async def get(self, id: int) -> Optional[ModelType]:
        query = select(self.model).where(self.model.id == id)
        result = await self.db.execute(query)
        return result.scalar_one_or_none()
    
    async def get_all(self, skip: int = 0, limit: int = 100) -> List[ModelType]:
        query = select(self.model).offset(skip).limit(limit)
        result = await self.db.execute(query)
        return result.scalars().all()
    
    async def create(self, **kwargs) -> ModelType:
        instance = self.model(**kwargs)
        self.db.add(instance)
        await self.db.commit()
        await self.db.refresh(instance)
        return instance
    
    async def update(self, id: int, **kwargs) -> Optional[ModelType]:
        query = (
            update(self.model)
            .where(self.model.id == id)
            .values(**kwargs)
            .returning(self.model)
        )
        result = await self.db.execute(query)
        await self.db.commit()
        return result.scalar_one_or_none() if result else None
    
    async def delete(self, id: int) -> bool:
        query = delete(self.model).where(self.model.id == id)
        result = await self.db.execute(query)
        await self.db.commit()
        return result.rowcount > 0
```

**app/repositories/book_repository.py:**
```python
from typing import Optional, List
from sqlalchemy import select, and_, or_, desc, asc
from app.repositories.base import BaseRepository
from app.models.book import Book
from app.models.author import Author

class BookRepository(BaseRepository[Book]):
    def __init__(self, db):
        super().__init__(Book, db)
    
    async def search(
        self,
        query: Optional[str] = None,
        author_id: Optional[int] = None,
        min_year: Optional[int] = None,
        max_year: Optional[int] = None,
        min_price: Optional[float] = None,
        max_price: Optional[float] = None,
        available_only: bool = False,
        sort_by: str = "created_at",
        sort_order: str = "desc",
        skip: int = 0,
        limit: int = 100
    ) -> List[Book]:
        stmt = select(Book).join(Author)
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
        conditions = []
        
        if query:
            conditions.append(
                or_(
                    Book.title.ilike(f"%{query}%"),
                    Book.description.ilike(f"%{query}%"),
                    Author.name.ilike(f"%{query}%")
                )
            )
        
        if author_id:
            conditions.append(Book.author_id == author_id)
        
        if min_year:
            conditions.append(Book.publication_year >= min_year)
        
        if max_year:
            conditions.append(Book.publication_year <= max_year)
        
        if min_price:
            conditions.append(Book.price >= min_price)
        
        if max_price:
            conditions.append(Book.price <= max_price)
        
        if available_only:
            conditions.append(Book.available_copies > 0)
        
        if conditions:
            stmt = stmt.where(and_(*conditions))
        
        # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
        if sort_by == "title":
            order_column = Book.title
        elif sort_by == "year":
            order_column = Book.publication_year
        elif sort_by == "price":
            order_column = Book.price
        elif sort_by == "rating":
            order_column = Book.average_rating
        else:
            order_column = Book.created_at
        
        if sort_order == "desc":
            stmt = stmt.order_by(desc(order_column))
        else:
            stmt = stmt.order_by(asc(order_column))
        
        # –ü–∞–≥–∏–Ω–∞—Ü–∏—è
        stmt = stmt.offset(skip).limit(limit)
        
        result = await self.db.execute(stmt)
        return result.scalars().all()
    
    async def count_search(self, **filters) -> int:
        """–ü–æ–¥—Å—á–µ—Ç –∫–Ω–∏–≥ —Å —É—á–µ—Ç–æ–º —Ñ–∏–ª—å—Ç—Ä–æ–≤"""
        stmt = select(Book).join(Author)
        
        conditions = []
        if "query" in filters and filters["query"]:
            conditions.append(
                or_(
                    Book.title.ilike(f"%{filters['query']}%"),
                    Author.name.ilike(f"%{filters['query']}%")
                )
            )
        
        if conditions:
            stmt = stmt.where(and_(*conditions))
        
        result = await self.db.execute(stmt)
        return len(result.scalars().all())
```

### **–®–∞–≥ 8: –°–µ—Ä–≤–∏—Å—ã**

**app/services/book_service.py:**
```python
from typing import List, Optional, Dict, Any
from sqlalchemy.ext.asyncio import AsyncSession
from fastapi import HTTPException, status

from app.repositories.book_repository import BookRepository
from app.repositories.author_repository import AuthorRepository
from app.schemas.book import BookCreate, BookUpdate, BookResponse

class BookService:
    def __init__(self, db: AsyncSession):
        self.book_repo = BookRepository(db)
        self.author_repo = AuthorRepository(db)
    
    async def get_books(
        self,
        query: Optional[str] = None,
        author_id: Optional[int] = None,
        min_year: Optional[int] = None,
        max_year: Optional[int] = None,
        min_price: Optional[float] = None,
        max_price: Optional[float] = None,
        available_only: bool = False,
        sort_by: str = "created_at",
        sort_order: str = "desc",
        page: int = 1,
        size: int = 20
    ) -> Dict[str, Any]:
        skip = (page - 1) * size
        
        books = await self.book_repo.search(
            query=query,
            author_id=author_id,
            min_year=min_year,
            max_year=max_year,
            min_price=min_price,
            max_price=max_price,
            available_only=available_only,
            sort_by=sort_by,
            sort_order=sort_order,
            skip=skip,
            limit=size
        )
        
        total = await self.book_repo.count_search(query=query)
        
        return {
            "items": [BookResponse.model_validate(book) for book in books],
            "total": total,
            "page": page,
            "size": size,
            "pages": (total + size - 1) // size
        }
    
    async def get_book(self, book_id: int) -> BookResponse:
        book = await self.book_repo.get(book_id)
        if not book or book.is_deleted:
            raise HTTPException(
                status_code=status.HTTP_404_NOT_FOUND,
                detail="–ö–Ω–∏–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
            )
        
        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
        book.view_count = getattr(book, 'view_count', 0) + 1
        await self.book_repo.db.commit()
        
        return BookResponse.model_validate(book)
    
    async def create_book(self, book_data: BookCreate, user_id: int) -> BookResponse:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∞
        author = await self.author_repo.get(book_data.author_id)
        if not author:
            raise HTTPException(
                status_code=status.HTTP_404_NOT_FOUND,
                detail="–ê–≤—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"
            )
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å ISBN
        existing_book = await self.book_repo.get_by_isbn(book_data.isbn)
        if existing_book:
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="–ö–Ω–∏–≥–∞ —Å —Ç–∞–∫–∏–º ISBN —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
            )
        
        # –°–æ–∑–¥–∞–µ–º –∫–Ω–∏–≥—É
        book_dict = book_data.model_dump()
        book_dict["available_copies"] = book_dict["total_copies"]
        book_dict["created_by"] = user_id
        
        book = await self.book_repo.create(**book_dict)
        
        return BookResponse.model_validate(book)
```

### **–®–∞–≥ 9: Endpoints**

**app/api/v1/endpoints/books.py:**
```python
from fastapi import APIRouter, Depends, HTTPException, status, Query
from typing import Optional
from sqlalchemy.ext.asyncio import AsyncSession

from app.api.deps import get_db, get_current_user, require_roles
from app.schemas.book import BookCreate, BookUpdate, BookResponse
from app.services.book_service import BookService
from app.models.user import UserRole

router = APIRouter(prefix="/books", tags=["books"])

@router.get("/", response_model=dict)
async def get_books(
    q: Optional[str] = Query(None, description="–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å"),
    author_id: Optional[int] = Query(None, description="ID –∞–≤—Ç–æ—Ä–∞"),
    min_year: Optional[int] = Query(None, ge=1000, description="–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≥–æ–¥"),
    max_year: Optional[int] = Query(None, le=2100, description="–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≥–æ–¥"),
    min_price: Optional[float] = Query(None, ge=0, description="–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞"),
    max_price: Optional[float] = Query(None, ge=0, description="–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞"),
    available_only: bool = Query(False, description="–¢–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ"),
    sort_by: str = Query("created_at", description="–ü–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"),
    sort_order: str = Query("desc", regex="^(asc|desc)$"),
    page: int = Query(1, ge=1, description="–°—Ç—Ä–∞–Ω–∏—Ü–∞"),
    size: int = Query(20, ge=1, le=100, description="–†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã"),
    db: AsyncSession = Depends(get_db),
):
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π"""
    book_service = BookService(db)
    return await book_service.get_books(
        query=q,
        author_id=author_id,
        min_year=min_year,
        max_year=max_year,
        min_price=min_price,
        max_price=max_price,
        available_only=available_only,
        sort_by=sort_by,
        sort_order=sort_order,
        page=page,
        size=size
    )

@router.get("/{book_id}", response_model=BookResponse)
async def get_book(
    book_id: int,
    db: AsyncSession = Depends(get_db),
):
    """–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ"""
    book_service = BookService(db)
    return await book_service.get_book(book_id)

@router.post("/", response_model=BookResponse, status_code=status.HTTP_201_CREATED)
async def create_book(
    book_data: BookCreate,
    db: AsyncSession = Depends(get_db),
    current_user: dict = Depends(require_roles([UserRole.LIBRARIAN, UserRole.ADMIN])),
):
    """–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–Ω–∏–≥—É"""
    book_service = BookService(db)
    return await book_service.create_book(book_data, current_user["id"])

@router.put("/{book_id}", response_model=BookResponse)
async def update_book(
    book_id: int,
    book_data: BookUpdate,
    db: AsyncSession = Depends(get_db),
    current_user: dict = Depends(require_roles([UserRole.LIBRARIAN, UserRole.ADMIN])),
):
    """–û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ"""
    book_service = BookService(db)
    return await book_service.update_book(book_id, book_data, current_user["id"])

@router.delete("/{book_id}", status_code=status.HTTP_204_NO_CONTENT)
async def delete_book(
    book_id: int,
    db: AsyncSession = Depends(get_db),
    current_user: dict = Depends(require_roles([UserRole.ADMIN])),
):
    """–£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É"""
    book_service = BookService(db)
    success = await book_service.delete_book(book_id, current_user["id"])
    
    if not success:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É"
        )
```

### **–®–∞–≥ 10: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

**app/dependencies/auth.py:**
```python
from fastapi import Depends, HTTPException, status
from fastapi.security import OAuth2PasswordBearer
from jose import JWTError, jwt
from app.core.config import settings
from app.services.auth_service import AuthService
from app.dependencies.database import get_db
from sqlalchemy.ext.asyncio import AsyncSession

oauth2_scheme = OAuth2PasswordBearer(tokenUrl=f"{settings.API_V1_STR}/auth/login")

async def get_current_user(
    token: str = Depends(oauth2_scheme),
    db: AsyncSession = Depends(get_db),
) -> dict:
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
        headers={"WWW-Authenticate": "Bearer"},
    )
    
    try:
        payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
        user_id: int = payload.get("sub")
        if user_id is None:
            raise credentials_exception
    except JWTError:
        raise credentials_exception
    
    auth_service = AuthService(db)
    user = await auth_service.get_user_by_id(user_id)
    
    if user is None or not user.is_active:
        raise credentials_exception
    
    return {
        "id": user.id,
        "email": user.email,
        "username": user.username,
        "role": user.role,
        "is_active": user.is_active
    }

def require_roles(required_roles: list):
    """–§–∞–±—Ä–∏–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π"""
    async def role_checker(current_user: dict = Depends(get_current_user)):
        if current_user["role"] not in required_roles:
            raise HTTPException(
                status_code=status.HTTP_403_FORBIDDEN,
                detail="–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤"
            )
        return current_user
    return role_checker
```

### **–®–∞–≥ 11: –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**

**app/main.py:**
```python
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from contextlib import asynccontextmanager

from app.api.v1.api import api_router
from app.core.config import settings
from app.core.database import init_db
import logging

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

@asynccontextmanager
async def lifespan(app: FastAPI):
    """–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    # –ó–∞–ø—É—Å–∫
    logger.info("Starting up...")
    await init_db()
    logger.info("Database initialized")
    
    yield
    
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
    logger.info("Shutting down...")

app = FastAPI(
    title=settings.PROJECT_NAME,
    version=settings.VERSION,
    openapi_url=f"{settings.API_V1_STR}/openapi.json",
    lifespan=lifespan,
)

# CORS
if settings.BACKEND_CORS_ORIGINS:
    app.add_middleware(
        CORSMiddleware,
        allow_origins=[str(origin) for origin in settings.BACKEND_CORS_ORIGINS],
        allow_credentials=True,
        allow_methods=["*"],
        allow_headers=["*"],
    )

# –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ä–æ—É—Ç–µ—Ä—ã
app.include_router(api_router, prefix=settings.API_V1_STR)

@app.get("/")
async def root():
    return {
        "message": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Library API",
        "version": settings.VERSION,
        "docs": "/docs",
        "health": "/health"
    }

@app.get("/health")
async def health_check():
    return {"status": "healthy"}
```

## **üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–¢–µ—Å—Ç—ã API:**
```python
# tests/test_api/test_books.py
import pytest
from fastapi.testclient import TestClient
from app.main import app

client = TestClient(app)

def test_get_books():
    response = client.get("/api/v1/books/")
    assert response.status_code == 200
    data = response.json()
    assert "items" in data
    assert "total" in data
    assert "page" in data

def test_get_book_not_found():
    response = client.get("/api/v1/books/999999")
    assert response.status_code == 404

def test_create_book_unauthorized():
    book_data = {
        "title": "–¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–∏–≥–∞",
        "isbn": "978-5-4461-1234-5",
        "author_id": 1,
        "publication_year": 2024,
        "price": 1000.0
    }
    response = client.post("/api/v1/books/", json=book_data)
    assert response.status_code == 401  # –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
```

### **–¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤:**
```python
# tests/test_services/test_book_service.py
import pytest
from unittest.mock import AsyncMock, Mock
from app.services.book_service import BookService

@pytest.mark.asyncio
async def test_get_books():
    mock_db = AsyncMock()
    mock_repo = Mock()
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –º–æ–∫
    mock_repo.search.return_value = []
    mock_repo.count_search.return_value = 0
    
    service = BookService(mock_db)
    service.book_repo = mock_repo
    
    result = await service.get_books()
    
    assert "items" in result
    assert result["total"] == 0
    assert result["page"] == 1
    mock_repo.search.assert_called_once()
```

## **üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞**

### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (–º–∞–∫—Å–∏–º—É–º 50 –±–∞–ª–ª–æ–≤):**
1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞** (10 –±–∞–ª–ª–æ–≤):
   - –ß–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
   - –ò–º–ø–æ—Ä—Ç—ã –±–µ–∑ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

2. **–†–∞–±–æ—Ç–∞ —Å –ë–î** (15 –±–∞–ª–ª–æ–≤):
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ SQLAlchemy
   - –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
   - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π

3. **API Endpoints** (15 –±–∞–ª–ª–æ–≤):
   - –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP –º–µ—Ç–æ–¥—ã –∏ —Å—Ç–∞—Ç—É—Å—ã
   - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

4. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** (10 –±–∞–ª–ª–æ–≤):
   - JWT —Ç–æ–∫–µ–Ω—ã
   - –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å
   - –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints

### **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (–º–∞–∫—Å–∏–º—É–º 30 –±–∞–ª–ª–æ–≤):**
1. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** (10 –±–∞–ª–ª–æ–≤):
   - Type hints
   - Docstrings
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (10 –±–∞–ª–ª–æ–≤):
   - Unit —Ç–µ—Å—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
   - API —Ç–µ—Å—Ç—ã
   - –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ > 70%

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (5 –±–∞–ª–ª–æ–≤):
   - Swagger/ReDoc
   - README.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
   - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

4. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** (5 –±–∞–ª–ª–æ–≤):
   - –ü–æ–∏—Å–∫ —Å –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–∏—Å–∫–æ–º
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
   - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

### **–ë–æ–Ω—É—Å–Ω—ã–µ –±–∞–ª–ª—ã (–º–∞–∫—Å–∏–º—É–º 20 –±–∞–ª–ª–æ–≤):**
1. **Docker** (5 –±–∞–ª–ª–æ–≤):
   - Dockerfile
   - docker-compose.yml
   - –ú—É–ª—å—Ç–∏-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

2. **CI/CD** (5 –±–∞–ª–ª–æ–≤):
   - GitHub Actions/GitLab CI
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (5 –±–∞–ª–ª–æ–≤):
   - –õ–æ–≥–∏ –≤ —Ñ–∞–π–ª
   - –ú–µ—Ç—Ä–∏–∫–∏ Prometheus
   - Health checks

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** (5 –±–∞–ª–ª–æ–≤):
   - –ò–Ω–¥–µ–∫—Å—ã –≤ –ë–î
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

## **üìö –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API**

### **1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```bash
curl -X POST "http://localhost:8000/api/v1/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "username": "john_doe",
    "password": "secure_password",
    "full_name": "John Doe"
  }'
```

### **2. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É:**
```bash
curl -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "john_doe",
    "password": "secure_password"
  }'
```

### **3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–Ω–∏–≥:**
```bash
curl -X GET "http://localhost:8000/api/v1/books/?q=–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ&page=1&size=10" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### **4. –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:**
```bash
curl -X POST "http://localhost:8000/api/v1/bookings/" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "book_id": 1,
    "start_date": "2024-01-20",
    "end_date": "2024-02-03"
  }'
```

## **üîç –°–æ–≤–µ—Ç—ã –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏:**
1. **–î–µ–Ω—å 1-2:** –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –º–æ–¥–µ–ª–∏
2. **–î–µ–Ω—å 3:** –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã
3. **–î–µ–Ω—å 4:** API endpoints
4. **–î–µ–Ω—å 5:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. **–î–µ–Ω—å 6:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
6. **–î–µ–Ω—å 7:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### **–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è:**
1. **–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –∏ —Ä–∞–∑–¥–µ–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. **–ü—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å—é:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `await` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pydantic –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–≥–∏–Ω–∞—Ü–∏—é –∏ –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î

### **–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
fastapi dev app/main.py

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
python scripts/init_db.py

# –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
python scripts/seed_data.py

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–π (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Alembic)
alembic revision --autogenerate -m "Initial migration"
alembic upgrade head
```

## **üéØ –ò—Ç–æ–≥ –Ω–µ–¥–µ–ª–∏ 8**

–ö –∫–æ–Ω—Ü—É –Ω–µ–¥–µ–ª–∏ —É –≤–∞—Å –±—É–¥–µ—Ç **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ REST API –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–Ω–∏–≥**, –∫–æ—Ç–æ—Ä–æ–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—Å–µ –∏–∑—É—á–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ FastAPI. –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å—Ç–∞–Ω–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–º –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫ –≤–∞—à–µ–º—É –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∏ –ø–æ–∫–∞–∂–µ—Ç —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è–º –≤–∞—à–∏ –Ω–∞–≤—ã–∫–∏ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

**–ö–ª—é—á–µ–≤—ã–µ –Ω–∞–≤—ã–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç–µ:**
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ RESTful API
- –†–∞–±–æ—Ç–∞ —Å SQL –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–£–¥–∞—á–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞! –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ –∏–¥–µ–∞–ª—å–Ω—ã–π –∫–æ–¥, –∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –∏ —É–º–µ–Ω–∏–µ —Ä–µ—à–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏.